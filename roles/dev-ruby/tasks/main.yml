---
# File: roles/dev-ruby/tasks/main.yml

- name: Install rbenv stuff
  homebrew: name={{ item }}
  with_items:
    - rbenv
    - ruby-build
  when: ansible_os_family == "Darwin"

- name: Install ruby versions
  shell: rbenv install {{ item }}
  args:
    creates: ~/.rbenv/versions/{{ item }}
  with_items: ruby_versions
  when: ansible_os_family == "Darwin"

- name: Install ruby gems
  gem: name="{{ item[0] }}" executable=~/.rbenv/shims/gem user_install=no
  notify: rehash rbenv
  environment:
    RBENV_VERSION: "{{ item[1] }}"
  tags:
    - ruby
  with_nested:
    - ruby_gems
    - ruby_versions
  when: ansible_os_family == "Darwin"

- name: Set default ruby version
  shell: rbenv global {{ ruby_default }}
  args:
    creates: ~/.rbenv/version
  when: ansible_os_family == "Darwin"

# @TODO: CentOS

